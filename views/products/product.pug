extends ../layout/commom.pug
block content 
  h1 
    a(href="/products") Products
  h1 
    a(href="/book") All books
  form(action="/products/search" , method="GET").d-flex
    input.form-control(type="text",placeholder="Search", id="search" ,name="name" ,style="width:200px;margin-right:30px" )
    button(class="btn btn-primary") Search 
  br
  br
  .product
    .row
      p= nothing
      each item in products
        .col-lg-3.col-sm-6.col-12.khung-anh
          .wrapper-product
            .img-product(style=`background-image: url("/images/${Math.floor(Math.random() * 7) + 1}.jpg")`)
            .details
              h4= item.name 
              p= item.description 
              i= item.price +" $"
              a(href="/products/" + item.id + `?page=${pageCurrent}`).btn.btn-primary Buy Now
  .number-page
    nav(aria-label='Page navigation example')
      ul.pagination
        li.page-item
          a#pre.page-link Previous
        li.page-item
          a.page-link.id-link(href=`/products?page=${1}`)= fixed1
        li.page-item
          a.page-link.id-link(href=`/products?page=${2}`)= fixed2
        li.page-item
          a.page-link.id-link(href=`/products?page=${3}`)= fixed3
        li.page-item
          a#next.page-link Next
  script.
    var arr = Array.from(document.getElementsByClassName('id-link'));
    var value = arr.map(ele => {
    return parseInt(ele.text);
    })
    for(var i = 0; i < 3 ; i++ ){
     arr[i].setAttribute('href', `products?page=${value[i]}`);
    }
    document.getElementById('next').addEventListener('click', function () {
    var value = arr.map(ele => {
    return parseInt(ele.text);
    })
    console.log("current: " + value);
    if (value[0] == 13) {
    arr[1].text = "";
    arr[2].text = "";
    return;
    }
    var newValue = value.map(ele => {
    return ele + 3;
    })
    console.log("next" + newValue);
    for (var i = 0; i < 3; i++) {
    arr[i].text = newValue[i];
    if (newValue[i] == 13) {
    arr[i].setAttribute('href', `products?page=13`);
    arr[i+1].text = "";
    arr[i+2].text = ""; 
    arr[i+1].setAttribute('id' , 'none');
    arr[i+2].setAttribute('id' , 'none');
    return;
    }
    }
    for(var i = 0; i < 3 ; i++ ){
    arr[i].setAttribute('href', `products?page=${newValue[i]}`);
    }
    })

    //console.log(arr[1].text);
    document.getElementById('pre').addEventListener('click', function () {
    var arr = Array.from(document.getElementsByClassName('id-link'));
    if(arr[1].text == "" || arr[2].text == "") {
    arr[1].text = 14;
    arr[2].text = 15;
    arr[1].setAttribute('id' , 'none');
    arr[2].setAttribute('id' , 'none');
    }
    var value = arr.map(ele => {
    return parseInt(ele.text);
    })
    if (value[0] == 1) {
    return;
    }
    var newValue = value.map(ele => {
    return ele - 3;
    })
    console.log(newValue);
    if(newValue[0] == 10) {
    arr[1].setAttribute('id' , 'block');
    arr[2].setAttribute('id' , 'block');
    }
    for (var i = 0; i < 3; i++) {
    arr[i].text = newValue[i];
    }
    console.log(newValue);
    for(var i = 0; i < 3 ; i++ ){
    arr[i].setAttribute('href', `products?page=${newValue[i]}`);
    }
    })

